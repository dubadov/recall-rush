<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recall Rush</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/animations.css">
  <link rel="stylesheet" href="css/rtl.css">
</head>
<body>
  <!-- Language Toggle (floating, visible on all screens) -->
  <button id="lang-toggle" class="lang-toggle" aria-label="Switch language">עב</button>

  <div id="app">

    <!-- ============ SETUP SCREEN ============ -->
    <section id="screen-setup" class="screen active">
      <div class="screen-content setup-layout">
        <div class="setup-hero">
          <div class="logo-mark">R</div>
          <h1 class="logo-title" data-i18n="logoTitle">Recall Rush</h1>
          <p class="logo-subtitle" data-i18n="logoSubtitle">Master your vocabulary under pressure</p>
        </div>
        <div class="setup-card glass-card">
          <h2 data-i18n="getStarted">Get Started</h2>
          <p class="setup-desc" data-i18n="setupDesc">Enter your free Groq API key for AI-generated vocabulary, or skip to use the built-in word bank.</p>
          <div class="input-group">
            <input type="password" id="api-key-input" class="input-field" placeholder="gsk_..." autocomplete="off" />
            <a href="https://console.groq.com" target="_blank" class="input-hint-link" data-i18n="getFreeKey">Get free key</a>
          </div>
          <button id="save-api-key" class="btn btn-primary" data-i18n="saveAndStart">Save & Start</button>
          <button id="skip-api-key" class="btn btn-ghost" data-i18n="skipForNow">Skip for now</button>
        </div>
      </div>
    </section>

    <!-- ============ MAIN MENU ============ -->
    <section id="screen-menu" class="screen">
      <div class="screen-content menu-layout">
        <header class="menu-header">
          <div class="menu-header-left">
            <h1 class="logo-text">Recall<span class="logo-accent">Rush</span></h1>
          </div>
          <div class="menu-header-right">
            <div class="header-stat">
              <span class="header-stat-value" id="menu-xp">0</span>
              <span class="header-stat-label" data-i18n="xpLabel">XP</span>
            </div>
            <div class="header-stat">
              <span class="header-stat-value" id="menu-level">1</span>
              <span class="header-stat-label" data-i18n="levelLabel">Level</span>
            </div>
            <div class="header-stat streak-stat">
              <span class="header-stat-value" id="menu-streak">0</span>
              <span class="header-stat-label" data-i18n="streakLabel">Streak</span>
            </div>
          </div>
        </header>

        <!-- Daily Challenge Banner -->
        <div class="daily-banner glass-card" id="daily-challenge">
          <div class="daily-badge" data-i18n="dailyBadge">DAILY</div>
          <div class="daily-info">
            <p class="daily-text" id="daily-challenge-text" data-i18n="dailyText">Complete all 10 rounds in Definition Match</p>
          </div>
          <button class="btn btn-accent btn-sm" id="start-daily" data-i18n="dailyGo">Go</button>
        </div>

        <!-- Global Difficulty Selector -->
        <div class="difficulty-selector glass-card" id="difficulty-selector">
          <div class="diff-header">
            <span class="diff-label">Difficulty</span>
            <span class="diff-level-name" id="diff-level-name">Medium</span>
          </div>
          <div class="diff-buttons">
            <button class="diff-btn" data-level="1"><span class="diff-num">1</span><span class="diff-name">Beginner</span></button>
            <button class="diff-btn" data-level="2"><span class="diff-num">2</span><span class="diff-name">Easy</span></button>
            <button class="diff-btn active" data-level="3"><span class="diff-num">3</span><span class="diff-name">Medium</span></button>
            <button class="diff-btn" data-level="4"><span class="diff-num">4</span><span class="diff-name">Hard</span></button>
            <button class="diff-btn" data-level="5"><span class="diff-num">5</span><span class="diff-name">Master</span></button>
          </div>
          <div class="diff-info" id="diff-info">Balanced words &bull; 10s timer</div>
        </div>

        <!-- Game Mode Cards -->
        <div class="mode-grid">
          <div class="mode-card glass-card" data-mode="definition-match">
            <div class="mode-icon-wrap"><span class="mode-icon">&#128218;</span></div>
            <div class="mode-info">
              <h3 data-i18n="definitionMatchTitle">Definition Match</h3>
              <p data-i18n="definitionMatchDesc">Pick the correct definition for each word</p>
            </div>
            <div class="mode-meta">
              <span class="difficulty-dot dot-green"></span>
              <span class="mode-best" id="best-definition-match">--</span>
            </div>
          </div>

          <div class="mode-card glass-card" data-mode="sentence-fill">
            <div class="mode-icon-wrap"><span class="mode-icon">&#128172;</span></div>
            <div class="mode-info">
              <h3 data-i18n="sentenceFillTitle">Sentence Fill</h3>
              <p data-i18n="sentenceFillDesc">Say the word that best completes the sentence</p>
            </div>
            <div class="mode-meta">
              <span class="difficulty-dot dot-yellow"></span>
              <span class="mode-best" id="best-sentence-fill">--</span>
            </div>
          </div>

          <div class="mode-card glass-card" data-mode="recall-challenge">
            <div class="mode-icon-wrap"><span class="mode-icon">&#129504;</span></div>
            <div class="mode-info">
              <h3 data-i18n="recallChallengeTitle">Recall Challenge</h3>
              <p data-i18n="recallChallengeDesc">See the definition, say the word from memory</p>
            </div>
            <div class="mode-meta">
              <span class="difficulty-dot dot-orange"></span>
              <span class="mode-best" id="best-recall-challenge">--</span>
            </div>
          </div>

          <div class="mode-card glass-card" data-mode="word-upgrade">
            <div class="mode-icon-wrap"><span class="mode-icon">&#11014;</span></div>
            <div class="mode-info">
              <h3 data-i18n="wordUpgradeTitle">Word Upgrade</h3>
              <p data-i18n="wordUpgradeDesc">Replace the common word with a more elevated synonym</p>
            </div>
            <div class="mode-meta">
              <span class="difficulty-dot dot-red"></span>
              <span class="mode-best" id="best-word-upgrade">--</span>
            </div>
          </div>
        </div>

        <!-- Bottom Nav -->
        <nav class="bottom-nav">
          <button class="nav-btn active" data-nav="menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            <span data-i18n="navHome">Home</span>
          </button>
          <button class="nav-btn" data-nav="stats">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="18" y="3" width="4" height="18"/><rect x="10" y="8" width="4" height="13"/><rect x="2" y="13" width="4" height="8"/></svg>
            <span data-i18n="navStats">Stats</span>
          </button>
          <button class="nav-btn" data-nav="settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            <span data-i18n="navSettings">Settings</span>
          </button>
        </nav>
      </div>
    </section>

    <!-- ============ GAME SCREEN ============ -->
    <section id="screen-game" class="screen">
      <div class="screen-content game-layout">
        <!-- Game Header -->
        <header class="game-header">
          <button class="btn btn-icon" id="game-back" aria-label="Back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
          </button>
          <h2 id="game-mode-title" class="game-title">Speed Recall</h2>
          <div class="game-header-stats">
            <div class="game-stat">
              <span class="game-stat-value" id="game-score">0</span>
              <span class="game-stat-label" data-i18n="ptsLabel">pts</span>
            </div>
            <div class="game-stat streak-active">
              <span class="game-stat-value" id="game-streak">0</span>
              <span class="game-stat-label" data-i18n="streakStatLabel">streak</span>
            </div>
          </div>
        </header>

        <!-- Timer -->
        <div class="timer-wrap">
          <div class="timer-track">
            <div class="timer-fill" id="timer-fill"></div>
          </div>
          <span class="timer-label" id="timer-text">10s</span>
        </div>

        <!-- Word Card -->
        <div class="word-card glass-card" id="word-card">
          <div class="word-main" id="word-main">UBIQUITOUS</div>
          <div class="word-divider"></div>
          <div class="word-definition" id="word-definition">present, appearing, or found everywhere</div>
          <div class="word-example" id="word-example">"Smartphones have become ubiquitous in modern society."</div>
        </div>

        <!-- Answer Grid (for Definition Match click + Sentence Fill display) -->
        <div class="answer-grid" id="answer-grid" style="display:none;">
          <button class="answer-btn glass-card" id="answer-btn-0" data-index="0"></button>
          <button class="answer-btn glass-card" id="answer-btn-1" data-index="1"></button>
          <button class="answer-btn glass-card" id="answer-btn-2" data-index="2"></button>
          <button class="answer-btn glass-card" id="answer-btn-3" data-index="3"></button>
        </div>

        <!-- Transcript -->
        <div class="transcript-bar" id="transcript-bar">
          <div class="transcript-mic">
            <div class="mic-pulse"></div>
          </div>
          <span class="transcript-text" id="transcript-text" data-i18n="listening">Listening...</span>
        </div>

        <!-- Actions -->
        <div class="game-actions">
          <button class="btn btn-ghost-sm" id="btn-skip" data-i18n="skipBtn">Skip</button>
          <button class="btn btn-ghost-sm" id="btn-hint" data-i18n="hintBtn">Hint</button>
        </div>

        <!-- Word Bomb Container (hidden by default) -->
        <div class="bomb-container" id="bomb-container" style="display:none;">
          <div class="bomb-body" id="bomb-body">
            <div class="bomb-fuse" id="bomb-fuse">
              <div class="fuse-spark" id="fuse-spark"></div>
            </div>
            <div class="bomb-circle">
              <span class="bomb-timer" id="bomb-timer">10</span>
            </div>
          </div>
        </div>

        <!-- Countdown Overlay -->
        <div class="overlay countdown-overlay" id="countdown-overlay">
          <div class="countdown-number" id="countdown-number">3</div>
        </div>

        <!-- Result Overlay -->
        <div class="overlay result-overlay" id="result-overlay">
          <div class="result-content">
            <div class="result-icon" id="result-icon"></div>
            <div class="result-text" id="result-text">Nice!</div>
            <div class="result-points" id="result-points">+100</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ============ GAME OVER SCREEN ============ -->
    <section id="screen-gameover" class="screen">
      <div class="screen-content gameover-layout">
        <div class="gameover-hero">
          <h2 class="gameover-label" data-i18n="gameOver">Game Over</h2>
          <div class="gameover-score" id="final-score">0</div>
          <div class="gameover-score-label" data-i18n="pointsLabel">points</div>
        </div>
        <div class="gameover-stats glass-card">
          <div class="go-stat">
            <span class="go-stat-value" id="go-words-completed">0</span>
            <span class="go-stat-label" data-i18n="wordsLabel">Words</span>
          </div>
          <div class="go-stat">
            <span class="go-stat-value" id="go-accuracy">0%</span>
            <span class="go-stat-label" data-i18n="accuracyLabel">Accuracy</span>
          </div>
          <div class="go-stat">
            <span class="go-stat-value" id="go-best-streak">0</span>
            <span class="go-stat-label" data-i18n="bestStreakLabel">Best Streak</span>
          </div>
          <div class="go-stat">
            <span class="go-stat-value" id="go-xp-earned">+0</span>
            <span class="go-stat-label" data-i18n="xpEarnedLabel">XP Earned</span>
          </div>
        </div>
        <div class="gameover-actions">
          <button class="btn btn-accent" id="btn-continue-sentence" style="display:none;" data-i18n="continueSentence">Continue to Sentence Fill</button>
          <button class="btn btn-primary" id="btn-play-again" data-i18n="playAgain">Play Again</button>
          <button class="btn btn-ghost" id="btn-back-menu" data-i18n="backToMenu">Back to Menu</button>
        </div>
      </div>
    </section>

    <!-- ============ STATS SCREEN ============ -->
    <section id="screen-stats" class="screen">
      <div class="screen-content stats-layout">
        <header class="section-header">
          <button class="btn btn-icon" id="stats-back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
          </button>
          <h2 data-i18n="statisticsTitle">Statistics</h2>
          <div></div>
        </header>
        <div class="stats-grid">
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-total-words">0</div>
            <div class="stat-card-label" data-i18n="wordsCompleted">Words Completed</div>
          </div>
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-accuracy">0%</div>
            <div class="stat-card-label" data-i18n="accuracyLabel">Accuracy</div>
          </div>
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-avg-time">0s</div>
            <div class="stat-card-label" data-i18n="avgResponse">Avg Response</div>
          </div>
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-best-streak">0</div>
            <div class="stat-card-label" data-i18n="bestStreakLabel">Best Streak</div>
          </div>
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-games-played">0</div>
            <div class="stat-card-label" data-i18n="gamesPlayed">Games Played</div>
          </div>
          <div class="stat-card glass-card">
            <div class="stat-card-value" id="stat-total-xp">0</div>
            <div class="stat-card-label" data-i18n="totalXP">Total XP</div>
          </div>
        </div>
        <h3 class="section-subtitle" data-i18n="wordsMastered">Words Mastered</h3>
        <div class="mastered-list" id="mastered-list">
          <p class="empty-state" data-i18n="noWordsMastered">No words mastered yet. Keep practicing!</p>
        </div>

        <nav class="bottom-nav">
          <button class="nav-btn" data-nav="menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            <span data-i18n="navHome">Home</span>
          </button>
          <button class="nav-btn active" data-nav="stats">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="18" y="3" width="4" height="18"/><rect x="10" y="8" width="4" height="13"/><rect x="2" y="13" width="4" height="8"/></svg>
            <span data-i18n="navStats">Stats</span>
          </button>
          <button class="nav-btn" data-nav="settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            <span data-i18n="navSettings">Settings</span>
          </button>
        </nav>
      </div>
    </section>

    <!-- ============ SETTINGS SCREEN ============ -->
    <section id="screen-settings" class="screen">
      <div class="screen-content settings-layout">
        <header class="section-header">
          <button class="btn btn-icon" id="settings-back">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
          </button>
          <h2 data-i18n="navSettings">Settings</h2>
          <div></div>
        </header>

        <div class="settings-group glass-card">
          <h3 class="settings-group-title" data-i18n="settingsGameTitle">Game</h3>
          <div class="setting-row">
            <label data-i18n="difficultyLabel">Difficulty Level</label>
            <select id="setting-difficulty" class="select-field">
              <option value="1">1 - Beginner</option>
              <option value="2">2 - Easy</option>
              <option value="3" selected>3 - Medium</option>
              <option value="4">4 - Hard</option>
              <option value="5">5 - Master</option>
            </select>
          </div>
          <div class="setting-row">
            <label for="setting-category" data-i18n="categoryLabel">Category</label>
            <select id="setting-category" class="select-field">
              <option value="general" selected data-i18n="catGeneral">General</option>
              <option value="business" data-i18n="catBusiness">Business</option>
              <option value="academic" data-i18n="catAcademic">Academic</option>
              <option value="creative" data-i18n="catCreative">Creative</option>
            </select>
          </div>
        </div>

        <div class="settings-group glass-card">
          <h3 class="settings-group-title" data-i18n="settingsApiTitle">API</h3>
          <div class="setting-row">
            <label for="settings-api-key" data-i18n="groqApiKey">Groq API Key</label>
            <input type="password" id="settings-api-key" class="input-field input-sm" placeholder="gsk_..." autocomplete="off" />
          </div>
          <div class="setting-row-actions">
            <button class="btn btn-primary btn-sm" id="save-settings-api" data-i18n="saveKey">Save Key</button>
            <a href="https://console.groq.com" target="_blank" class="setting-link" data-i18n="getFreeKey">Get free key</a>
          </div>
        </div>

        <div class="settings-group glass-card">
          <h3 class="settings-group-title" data-i18n="settingsDataTitle">Data</h3>
          <div class="setting-row-actions">
            <button class="btn btn-danger btn-sm" id="reset-progress" data-i18n="resetAllProgress">Reset All Progress</button>
          </div>
        </div>

        <nav class="bottom-nav">
          <button class="nav-btn" data-nav="menu">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            <span data-i18n="navHome">Home</span>
          </button>
          <button class="nav-btn" data-nav="stats">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="18" y="3" width="4" height="18"/><rect x="10" y="8" width="4" height="13"/><rect x="2" y="13" width="4" height="8"/></svg>
            <span data-i18n="navStats">Stats</span>
          </button>
          <button class="nav-btn active" data-nav="settings">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
            <span data-i18n="navSettings">Settings</span>
          </button>
        </nav>
      </div>
    </section>

  </div>

  <!-- Audio context for sound effects -->
  <script src="js/storage.js"></script>
  <script src="js/i18n.js"></script>
  <script src="js/sounds.js"></script>
  <script src="js/speech.js"></script>

  <script src="js/vocabulary.js"></script>
  <script src="js/progress.js"></script>
  <script src="js/game-modes/definition-match.js"></script>
  <script src="js/game-modes/sentence-fill.js"></script>
  <script src="js/game-modes/recall-challenge.js"></script>
  <script src="js/game-modes/word-upgrade.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
